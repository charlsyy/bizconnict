{% extends "dashboard/base_admin.html" %}
{% block title %}Orders â€” BizConnect Admin{% endblock %}
{% block admin_content %}
<div class="admin-header">
  <span class="label">Management</span>
  <h1 class="mt-1">All Orders</h1>
</div>

<div class="card table-wrap">
  <table>
    <thead><tr><th>Order #</th><th>Buyer</th><th>Items</th><th>Total</th><th>Status</th><th>Date</th><th>Action</th></tr></thead>
    <tbody>
      {% for o in orders %}
      <tr>
        <td style="font-family:var(--font-display);font-size:13px;">
          <a href="{% url 'order_detail' o.pk %}">{{ o.order_number }}</a>
        </td>
        <td>{{ o.buyer.username }}</td>
        <td>{{ o.items.count }}</td>
        <td style="font-weight:600;">&#8369;{{ o.total_amount|floatformat:2 }}</td>
        <td><span class="badge {% if o.status == 'delivered' %}badge-success{% elif o.status == 'cancelled' or o.status == 'refunded' %}badge-danger{% else %}badge-warning{% endif %}">{{ o.get_status_display }}</span></td>
        <td>{{ o.created_at|date:"M d, Y" }}</td>
        <td>
          <form method="post" action="{% url 'admin_update_order' o.pk %}">
            {% csrf_token %}
            <div class="flex gap-1">
              <select name="status" class="form-control" style="font-size:11px;padding:4px 6px;width:auto;">
                {% for val, label in o.get_status_choices %}
                  <option value="{{ val }}" {% if o.status == val %}selected{% endif %}>{{ label }}</option>
                {% endfor %}
              </select>
              <button type="submit" class="btn btn-dark btn-sm" style="font-size:11px;padding:5px 10px;">Set</button>
            </div>
          </form>
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% endblock %}