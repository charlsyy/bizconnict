{% extends "base.html" %}
{% block title %}Sales Reports — BizConnect{% endblock %}
{% block content %}
<div class="page">
  <div class="flex-between mb-5">
    <div>
      <span class="label">Analytics</span>
      <h1 class="mt-1">Sales Reports</h1>
    </div>
    <a href="?download=csv" class="btn btn-outline">Download CSV</a>
  </div>

  <div class="grid-3 mb-6">
    <div class="stat-card gold">
      <div class="stat-value">₱{{ total_revenue|floatformat:2 }}</div>
      <div class="stat-label">Total Revenue</div>
    </div>
    <div class="stat-card">
      <div class="stat-value">{{ total_orders }}</div>
      <div class="stat-label">Total Orders</div>
    </div>
    <div class="stat-card">
      <div class="stat-value">{{ total_items }}</div>
      <div class="stat-label">Items Sold</div>
    </div>
  </div>

  <div class="card table-wrap">
    <table>
      <thead><tr><th>Order #</th><th>Buyer</th><th>Product</th><th>Qty</th><th>Unit Price</th><th>Subtotal</th><th>Date</th></tr></thead>
      <tbody>
        {% for item in items %}
        <tr>
          <td>#{{ item.order.id }}</td>
          <td>{{ item.order.buyer.username }}</td>
          <td>{{ item.product_name }}</td>
          <td>{{ item.quantity }}</td>
          <td>₱{{ item.unit_price|floatformat:2 }}</td>
          <td>₱{{ item.subtotal|floatformat:2 }}</td>
          <td>{{ item.order.created_at|date:"M d, Y" }}</td>
        </tr>
        {% empty %}
        <tr><td colspan="7" class="text-center text-muted" style="padding:var(--sp-7);">No sales yet.</td></tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>
{% endblock %}v